{"version":3,"sources":["app.js"],"names":["window","document","undefined","angular","module","config","$urlRouterProvider","localStorageServiceProvider","otherwise","setPrefix","toastr","options","closeButton","debug","newestOnTop","progressBar","positionClass","preventDuplicates","onclick","showDuration","hideDuration","timeOut","extendedTimeOut","showEasing","hideEasing","showMethod","hideMethod","run","localStorageService","articles","$rootScope","$log","getAllArticles","then","response","$emit","set","error","data","get","controller","$scope","$http","$state","remove","$on","event","toState","toParams","currentStateName","name","currentStateParams","countCartItems","getUserData","genres","getAllGenres","logout","success","go","user","userName","userRole","role","cart","quantity","forEach","item","itemId","directive","restrict","link","scope","element","attrs","bind","isImage","$apply","filter","items","search","result","toLowerCase","value","key","indexOf","push","field","reverse","filtered","sort","a","b","$stateProvider","state","url","templateUrl","$stateParams","$uibModal","loadGame","id","actualGame","getElementById","setAttribute","image","stars","calculateAverageStars","reviews","innerHTML","description","calcPrice","warning","count","reviewsCount","tab","active","isValidQuantity","price","isNaN","Math","round","changeTab","type","toCart","parseInt","starsActivator","numbers","i","starHover","number","leave","rate","newReviewId","title","message","review","author","modalInstance","open","animation","resolve","articleId","addReview","console","log","searchInout","isAllGenres","genre","isArticles","isInvalid","updateTotalPrice","totalPrice","article","newObject","isInt","n","Number","quantityChange","newQuantity","checkPlatforms","selected","platform","bool","validatePrice","input","test","fsk","isTouched","isPriceInvalid","isPriceTouched","isCustomGenre","genreButtonText","changeInputStyle","priceValidation","imageToBase64","files","reader","FileReader","onload","e","target","readAsDataURL","isFloat","parseFloat","addArticle","customGenre","wiiu","windows","ps","xbox","osx","release","language","minRam","minProcessor","date","Date","getTime","platforms","isFormTouched","username","toCheckout","info","password","$","keydown","keyCode","click","login","orders","getOrders","factory","$q","trimPlatforms","trimmed","trim","service","q","defer","reject","mapped","_mapArticles","statusText","promise","ID","toString","Name","Genre","Preis","FSK","Plattformen","Release","Sprache","Beschreibung","Rezensionen","post","idArticle","Autor","Titel","Text","Datum","getTopGames","top","mappedItems","isNewGenre","mappedItem","_mapReviews","_mapOrders","order","mappedOrder","userId","idUser","Bestellungsartikel","Anzahl","mapCartItems","idOrder","addOrder","_mapUsers","Benutzername","email","Email","Rolle","addUser","Passwort","getAllUsers","users","deleteUser","topGames","loadUsers","$uibModalInstance","isNewReview","checkValid","isValid","submit","close","cancel","dismiss","passwordConfirm","pattern","register","length"],"mappings":"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","file":"app.min.js","sourcesContent":["(function(window, document, undefined) {\n'use strict';\nangular.module('app', [\r\n    'ui.router',\r\n    'ui.bootstrap',\r\n    'LocalStorageModule',\r\n    'ngAnimate',\r\n    'templates',\r\n    'textAngular',\r\n    // 'ngSanitize',\r\n    'app.home',\r\n    'app.addArticle',\r\n    'app.topGames',\r\n    'app.newGames',\r\n    'app.gameDetail',\r\n    'app.login',\r\n    'app.genre',\r\n    'app.cart',\r\n    'app.checkout',\r\n    'app.orders',\r\n    'app.userAdministration',\r\n    'app.register',\r\n    'app.passwordForget'\r\n])\r\n    .config([\"$urlRouterProvider\", \"localStorageServiceProvider\", function ($urlRouterProvider, localStorageServiceProvider) {\r\n        $urlRouterProvider.otherwise('/home');\r\n        localStorageServiceProvider.setPrefix('webshop');\r\n        toastr.options = {\r\n            \"closeButton\": false,\r\n            \"debug\": false,\r\n            \"newestOnTop\": true,\r\n            \"progressBar\": false,\r\n            \"positionClass\": \"toast-bottom-right\",\r\n            \"preventDuplicates\": false,\r\n            \"onclick\": null,\r\n            \"showDuration\": \"300\",\r\n            \"hideDuration\": \"1000\",\r\n            \"timeOut\": \"5000\",\r\n            \"extendedTimeOut\": \"1000\",\r\n            \"showEasing\": \"swing\",\r\n            \"hideEasing\": \"linear\",\r\n            \"showMethod\": \"fadeIn\",\r\n            \"hideMethod\": \"fadeOut\"\r\n        }\r\n    }])\r\n    .run([\"localStorageService\", \"articles\", \"$rootScope\", \"$log\", function (localStorageService, articles, $rootScope, $log) {\r\n        articles.getAllArticles()\r\n            .then(function (response) {\r\n                $rootScope.$emit('genresLoaded');\r\n                localStorageService.set('articles', response);\r\n            }, function (error) {\r\n                var data = localStorageService.get('articles');\r\n                if (data) {\r\n                    toastr.error('Artikel konnten nicht neu geladen werden. Daten wurden aus dem Cache geladen.')\r\n                } else {\r\n                    toastr.error('Artikel konnten nicht geladen werden.');\r\n                }\r\n                $log.error(error);\r\n            });\r\n        localStorageService.set('fromCheckout', false);\r\n    }])\r\n    .controller('AppCtrl', [\"$scope\", \"$rootScope\", \"$http\", \"localStorageService\", \"$state\", \"articles\", \"$log\", function ($scope, $rootScope, $http, localStorageService, $state, articles, $log) {\r\n        localStorageService.remove('checkout');\r\n        $rootScope.$on('$stateChangeSuccess',\r\n            function (event, toState, toParams) {\r\n                $scope.currentStateName = toState.name;\r\n                $scope.currentStateParams = toParams.name;\r\n            });\r\n\r\n        $rootScope.$on('itemAddedToCart', function () {\r\n            countCartItems();\r\n        });\r\n\r\n        $rootScope.$on('login', function () {\r\n            getUserData();\r\n        });\r\n        $scope.genres = localStorageService.get(\"genres\");\r\n\r\n        $rootScope.$on('genresLoaded', function () {\r\n            articles.getAllGenres()\r\n                .then(function (response) {\r\n                    $scope.genres = response;\r\n                }, function (error) {\r\n                    $log.error(error);\r\n                })\r\n        });\r\n\r\n        $rootScope.$on(\"articles-loaded\", function () {\r\n            $scope.genres = localStorageService.get(\"genres\");\r\n        });\r\n\r\n        $scope.logout = function () {\r\n            localStorageService.remove('user');\r\n            localStorageService.remove('orders');\r\n            localStorageService.remove('checkout');\r\n            // update user data\r\n            $rootScope.$emit('login');\r\n            $rootScope.$emit('itemAddedToCart');\r\n            toastr.success('Logout war erfolgreich.');\r\n            $state.go('login');\r\n        };\r\n\r\n        var getUserData = function () {\r\n            var user = localStorageService.get('user') || {};\r\n            $scope.userName = user.userName || 'Benutzer';\r\n            $scope.userRole = user.role;\r\n        };\r\n        getUserData();\r\n\r\n        var countCartItems = function () {\r\n            var cart = localStorageService.get('cart');\r\n            $scope.quantity = 0;\r\n            var articles = localStorageService.get('articles') || {};\r\n            angular.forEach(cart, function (item) {\r\n                if (articles[item.itemId]) {\r\n                    $scope.quantity += item.quantity;\r\n                } else {\r\n                    delete cart[item.itemId];\r\n                }\r\n            });\r\n            localStorageService.set('cart', cart);\r\n        };\r\n        countCartItems();\r\n    }])\r\n    .directive('imageonload', function () {\r\n        return {\r\n            restrict: 'A',\r\n            link: function (scope, element, attrs) {\r\n                element.bind('load', function () {\r\n                    scope.isImage = true;\r\n                    scope.$apply();\r\n                });\r\n                element.bind('error', function () {\r\n                    scope.isImage = false;\r\n                    scope.$apply();\r\n                });\r\n            }\r\n        };\r\n    })\r\n    .filter('objectFilter', function () {\r\n        return function (items, search) {\r\n            var result = [];\r\n            search = search ? search.toLowerCase() : '';\r\n            angular.forEach(items, function (value, key) {\r\n                if (value.name.toLowerCase().indexOf(search) !== -1) {\r\n                    result.push(value);\r\n                }\r\n            });\r\n            return result;\r\n\r\n        }\r\n    })\r\n    .filter('orderObjectBy', function() {\r\n        return function(items, field, reverse) {\r\n            var filtered = [];\r\n            angular.forEach(items, function(item) {\r\n                filtered.push(item);\r\n            });\r\n            filtered.sort(function (a, b) {\r\n                return (a[field] > b[field] ? 1 : -1);\r\n            });\r\n            if(reverse) filtered.reverse();\r\n            return filtered;\r\n        };\r\n    });\n\r\nangular.module('app.gameDetail', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('gameDetail', {\r\n            url : '/gameDetail/:id',\r\n            templateUrl : 'app/gameDetail/gameDetail.html',\r\n            controller : 'GameDetailCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('GameDetailCtrl', [\"$scope\", \"$http\", \"$stateParams\", \"localStorageService\", \"$uibModal\", \"$state\", \"articles\", \"$rootScope\", function ($scope, $http, $stateParams, localStorageService, $uibModal, $state, articles, $rootScope) {\r\n        $scope.tab = {};\r\n        $scope.tab.active = 'description';\r\n\r\n        $scope.quantity = 1;\r\n\r\n        $scope.isValidQuantity = true;\r\n        $scope.calcPrice = function () {\r\n            var price = $scope.actualGame.price * $scope.quantity;\r\n            if (isNaN(price) || $scope.quantity < 1 || $scope.quantity > 20) {\r\n                //&#8209; : minus without line break\r\n                $scope.price = \"Bitte gültige Anzahl (1&#8209;20) angeben!\";\r\n                $scope.isValidQuantity = false;\r\n            } else {\r\n                $scope.price = Math.round(price * 100) / 100;\r\n                $scope.isValidQuantity = true;\r\n            }\r\n        };\r\n        \r\n        loadGame();\r\n\r\n        function loadGame() {\r\n            var id = $stateParams.id;\r\n            $scope.articles = localStorageService.get('articles');\r\n            $scope.actualGame = $scope.articles[id];\r\n            if (!$scope.actualGame) {\r\n                toastr.warning('Das Spiel mit der ID ' + id + ' existiert nicht!');\r\n                $state.go('home');\r\n            } else {\r\n                document.getElementById('image').setAttribute('src', \"\" + $scope.actualGame.image);\r\n\r\n                $scope.stars = calculateAverageStars($scope.actualGame.reviews);\r\n                document.getElementById(\"description\").innerHTML = $scope.actualGame.description;\r\n                $scope.calcPrice();\r\n            }\r\n        }\r\n\r\n        $rootScope.$on(\"articles-loaded\", function () {\r\n            loadGame();\r\n        });\r\n\r\n        var user = localStorageService.get('user') || {};\r\n        var userName = user.userName;\r\n\r\n        function calculateAverageStars(data) {\r\n            var count = 0;\r\n            var stars = 0;\r\n            angular.forEach(data, function (item) {\r\n                count++;\r\n                stars += item.stars;\r\n            });\r\n            $scope.reviewsCount = count;\r\n            if (count === 0) {\r\n                return 0;\r\n            } else {\r\n                return stars / count;\r\n            }\r\n        }\r\n\r\n        $scope.changeTab = function (type) {\r\n            $scope.tab.active = type;\r\n        };\r\n\r\n        $scope.toCart = function () {\r\n            if ($scope.quantity >= 1) {\r\n                var cart = localStorageService.get('cart') || {};\r\n                if (cart[$scope.actualGame.id] && cart[$scope.actualGame.id].quantity) {\r\n                    cart[$scope.actualGame.id].quantity = parseInt(cart[$scope.actualGame.id].quantity) + parseInt($scope.quantity)\r\n                } else {\r\n                    cart[$scope.actualGame.id] = {\r\n                        itemId : $scope.actualGame.id,\r\n                        quantity : parseInt($scope.quantity)\r\n                    };\r\n                }\r\n                localStorageService.set('cart', cart);\r\n                $rootScope.$emit('itemAddedToCart');\r\n                toastr.success('Artikel erfolgreich ' + $scope.quantity + 'x in den Warenkorb gelegt!');\r\n                toastr.success('<img src=\"assets/img/giphy.gif\" ng-show=\"inCart\"/>');\r\n            } else {\r\n                toastr.warning('Bitte geben Sie eine gültige Zahl ein!')\r\n            }\r\n        };\r\n        $scope.starsActivator = {};\r\n        $scope.numbers = [1, 2, 3, 4, 5];\r\n        for (var i = 0; i <= 4; i++) {\r\n            $scope.starsActivator[$scope.numbers[i]] = false;\r\n        }\r\n\r\n        $scope.starHover = function (number) {\r\n            while (number > 0) {\r\n                $scope.starsActivator[number] = true;\r\n                number--;\r\n            }\r\n        };\r\n\r\n        $scope.leave = function () {\r\n            for (var i = 0; i <= 4; i++) {\r\n                $scope.starsActivator[$scope.numbers[i]] = false;\r\n            }\r\n        };\r\n\r\n        $scope.rate = function (stars) {\r\n            if (userName) {\r\n                var newReviewId = 1;\r\n                do {\r\n                    newReviewId++;\r\n                } while ($scope.actualGame.reviews[newReviewId]);\r\n                var title = '';\r\n                var message = '';\r\n                angular.forEach($scope.actualGame.reviews, function (review) {\r\n                    if (review.author == user.userName) {\r\n                        title = review.title;\r\n                        message = review.message;\r\n                        newReviewId = review.id;\r\n                    }\r\n                });\r\n                var modalInstance = $uibModal.open({\r\n                    animation : true,\r\n                    templateUrl : 'app/gameDetail/rating/rating.html',\r\n                    controller : 'RatingCtrl',\r\n                    resolve : {\r\n                        stars : function () {\r\n                            return stars;\r\n                        },\r\n                        title : function () {\r\n                            return title;\r\n                        },\r\n                        message : function () {\r\n                            return message;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                modalInstance.result.then(function (result) {\r\n                    var data = {\r\n                        id : 0,\r\n                        stars : result.stars,\r\n                        title : result.title,\r\n                        message : result.message,\r\n                        author : userName,\r\n                        articleId : $scope.actualGame.id\r\n                    };\r\n                    articles.addReview(data)\r\n                        .then(function () {\r\n                            toastr.success('Bewertung hinzugefügt!');\r\n                        }, function (error) {\r\n                            if (error) {\r\n                                toastr.error(error);\r\n                            } else {\r\n                                toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                            }\r\n                        });\r\n                }, function () {\r\n                    console.log('Modal dismissed');\r\n                });\r\n            } else {\r\n                toastr.warning('Bitte loggen Sie sich zuerst ein!');\r\n            }\r\n        };\r\n    }]);\n\r\nangular.module('app.genre', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('genre', {\r\n            url: '/genre/:name',\r\n            templateUrl: 'app/genre/genre.html',\r\n            controller: 'GenreCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('GenreCtrl', [\"$stateParams\", \"localStorageService\", \"$scope\", function ($stateParams, localStorageService, $scope) {\r\n        // TODO: order objects by id\r\n        $scope.searchInout = {};\r\n        $scope.isAllGenres = false;\r\n        $scope.genre = $stateParams.name;\r\n        var articles = localStorageService.get('articles');\r\n        $scope.articles = {};\r\n        $scope.isArticles = false;\r\n        if ($scope.genre != 'Alle Spiele') {\r\n            angular.forEach(articles, function (item) {\r\n                if (item.genre == $scope.genre) {\r\n                    $scope.isArticles = true;\r\n                    $scope.articles[item.id] = item;\r\n                }\r\n            });\r\n        } else {\r\n            $scope.isArticles = true;\r\n            $scope.isAllGenres = true;\r\n            $scope.articles = articles;\r\n        }\r\n    }]);\n\r\nangular.module('app.cart', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('cart', {\r\n            url: '/cart',\r\n            templateUrl: 'app/cart/cart.html',\r\n            controller: 'CartCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('CartCtrl', [\"localStorageService\", \"$scope\", \"$rootScope\", function (localStorageService, $scope, $rootScope) {\r\n        // cart only\r\n        var cart = localStorageService.get('cart');\r\n        // articles only\r\n        var articles = localStorageService.get('articles');\r\n        $scope.articles = articles;\r\n        // cart and articles merged\r\n        $scope.cart = {};\r\n        $scope.isInvalid = false;\r\n\r\n        $scope.updateTotalPrice = function () {\r\n            $scope.totalPrice = 0;\r\n            angular.forEach($scope.cart, function (item) {\r\n                $scope.totalPrice += item.quantity * item.price;\r\n            });\r\n        };\r\n\r\n        // merge cart and articles\r\n        angular.forEach(articles, function (article) {\r\n            angular.forEach(cart, function (item) {\r\n                if (item.itemId == article.id) {\r\n                    var newObject = article;\r\n                    newObject.quantity = item.quantity;\r\n                    console.log(newObject);\r\n                    $scope.cart[item.itemId] = newObject;\r\n                }\r\n            });\r\n        });\r\n        $scope.updateTotalPrice();\r\n\r\n        $scope.isInt = function (n) {\r\n            n = parseInt(n);\r\n            return Number(n) === n && n % 1 === 0;\r\n        };\r\n\r\n        $scope.quantityChange = function (id) {\r\n            var newQuantity = parseInt($scope.cart[id].quantity);\r\n            if (newQuantity < 1 || newQuantity > 20 || !$scope.isInt(newQuantity)) {\r\n                $scope.isInvalid = true;\r\n            } else {\r\n                $scope.isInvalid = false;\r\n                cart[id].quantity = newQuantity;\r\n                $scope.updateTotalPrice();\r\n                localStorageService.set('cart', cart);\r\n                $rootScope.$emit('itemAddedToCart');\r\n            }\r\n        };\r\n\r\n        $scope.remove = function (id) {\r\n            delete $scope.cart[id];\r\n            delete cart[id];\r\n            $scope.updateTotalPrice();\r\n            localStorageService.set('cart', cart);\r\n            $rootScope.$emit('itemAddedToCart');\r\n        }\r\n    }]);\n\r\nangular.module('app.addArticle', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('addArticle', {\r\n            url : '/addArticle',\r\n            templateUrl : 'app/addArticle/addArticle.html',\r\n            controller : 'AddArticleCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('AddArticleCtrl', [\"$scope\", \"articles\", \"$log\", \"$state\", function ($scope, articles, $log, $state) {\r\n        $scope.selected = {};\r\n        $scope.selected.platform = {};\r\n        $scope.selected.fsk = '0';\r\n        $scope.isTouched = false;\r\n        $scope.isPriceInvalid = false;\r\n        $scope.isPriceTouched = false;\r\n        $scope.isCustomGenre = false;\r\n        $scope.genreButtonText = 'Neues Genre anlegen';\r\n\r\n        function checkPlatforms() {\r\n            var selected = [];\r\n            angular.forEach($scope.selected.platform, function (bool, key) {\r\n                if (bool) {\r\n                    selected.push(key);\r\n                }\r\n            });\r\n            return selected;\r\n        }\r\n\r\n\r\n        articles.getAllGenres()\r\n            .then(function (response) {\r\n                $scope.genres = response;\r\n            }, function (error) {\r\n                $log.error(error);\r\n            });\r\n\r\n        function validatePrice(input) {\r\n            return /(?=.)^\\$?(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+)?(\\.[0-9]{1,2})?$/.test(input);\r\n        }\r\n\r\n        $scope.changeInputStyle = function () {\r\n            $scope.isCustomGenre ? $scope.isCustomGenre = false : $scope.isCustomGenre = true;\r\n            $scope.genreButtonText == 'Neues Genre anlegen' ? $scope.genreButtonText = 'Vorhandenes Genre auswählen' : $scope.genreButtonText = 'Neues Genre anlegen';\r\n        };\r\n\r\n        $scope.priceValidation = function () {\r\n            $scope.isPriceTouched = true;\r\n            !validatePrice($scope.price) ? $scope.isPriceInvalid = true : $scope.isPriceInvalid = false;\r\n        };\r\n\r\n        $scope.imageToBase64 = function (input) {\r\n            if (input.files && input.files[0]) {\r\n                var reader = new FileReader();\r\n\r\n                reader.onload = function (e) {\r\n                    console.log('image successfully converted to Base64');\r\n                    $scope.image = e.target.result;\r\n                    $scope.$apply();\r\n                };\r\n\r\n                reader.readAsDataURL(input.files[0]);\r\n            }\r\n        };\r\n\r\n        $scope.isInt = function (n) {\r\n            n = parseInt(n);\r\n            return Number(n) === n && n % 1 === 0;\r\n        };\r\n\r\n        $scope.isFloat = function (n) {\r\n            n = parseFloat(n);\r\n            return Number(n) === n && n % 1 !== 0;\r\n        };\r\n\r\n        $scope.addArticle = function () {\r\n            $scope.isTouched = true;\r\n            $scope.isPriceTouched = true;\r\n            $scope.isPriceInvalid = false;\r\n            if ($scope.title && (($scope.selected.genre && !$scope.isCustomGenre) || ($scope.customGenre && $scope.isCustomGenre))\r\n                && $scope.price && ($scope.selected.platform.wiiu ||\r\n                $scope.selected.platform.windows || $scope.selected.platform.ps || $scope.selected.platform.xbox ||\r\n                $scope.selected.platform.osx) && $scope.release && $scope.language && $scope.minRam &&\r\n                $scope.minProcessor && $scope.description && $scope.image) {\r\n                if (!validatePrice($scope.price)) {\r\n                    toastr.warning('Ungültiger Preis!');\r\n                    $scope.isPriceInvalid = true;\r\n                } else if (!$scope.isInt($scope.minRam)) {\r\n                    toastr.warning('Der Arbeitsspeicher muss mit einer natürlichen Zahl angegeben werden!');\r\n                } else if (!$scope.isFloat($scope.minProcessor) && !$scope.isInt($scope.minProcessor)) {\r\n                    toastr.warning('Der Prozessor muss mit einer Zahl angegeben werden! Für Nachkommastellen den Punkt verwenden!');\r\n                } else {\r\n                    var date = new Date($scope.release).getTime();\r\n                    var data = {\r\n                        id : 2,\r\n                        name : $scope.title,\r\n                        genre : $scope.isCustomGenre ? $scope.customGenre : $scope.selected.genre,\r\n                        price : $scope.price,\r\n                        fsk : $scope.selected.fsk,\r\n                        platforms : checkPlatforms(),\r\n                        release : date,\r\n                        language : $scope.language,\r\n                        minRam : $scope.minRam,\r\n                        minProcessor : $scope.minProcessor,\r\n                        description : $scope.description,\r\n                        image : $scope.image\r\n                    };\r\n                    console.log(data);\r\n                    articles.addArticle(data)\r\n                        .then(function (response) {\r\n                            toastr.success(response);\r\n                            $state.go(\"home\");\r\n                        }, function (error) {\r\n                            if (!error) {\r\n                                toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                            } else {\r\n                                toastr.error(error);\r\n                            }\r\n                        })\r\n                }\r\n            } else {\r\n                toastr.warning('Fehlende Informationen!');\r\n            }\r\n        }\r\n    }]);\n\r\nangular.module('app.home', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('home', {\r\n            url: '/home',\r\n            templateUrl: 'app/home/home.html',\r\n            controller: 'HomeCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('HomeCtrl', function () {\r\n\r\n    });\n\r\nangular.module('app.newGames', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('newGames', {\r\n            url: '/newGames',\r\n            templateUrl: 'app/newGames/newGames.html',\r\n            controller: 'NewGamesCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('NewGamesCtrl', function () {\r\n\r\n    });\n\r\nangular.module('app.login', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('login', {\r\n            url: '/login',\r\n            templateUrl: 'app/login/login.html',\r\n            controller: 'LoginCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('LoginCtrl', [\"$scope\", \"$state\", \"localStorageService\", \"$rootScope\", \"$http\", \"user\", function ($scope, $state, localStorageService, $rootScope, $http, user) {\r\n        $scope.isFormTouched = false;\r\n        var username = localStorageService.get('user') || {};\r\n        var toCheckout = localStorageService.get('fromCheckout');\r\n        if (username.userName) {\r\n            toastr.info('Sie sind bereits eingeloogt als \"' + username.userName + '\"!');\r\n            $state.go('home');\r\n        }\r\n        $scope.data = {};\r\n        $scope.data.password = '';\r\n        $scope.data.userName = '';\r\n\r\n        //Trigger Login when enter pressed\r\n        $(\"#username\").keydown(function (event) {\r\n            if (event.keyCode == 13) {\r\n                $(\"#submit\").click();\r\n            }\r\n        });\r\n        $(\"#password\").keydown(function (event) {\r\n            if (event.keyCode == 13) {\r\n                $(\"#submit\").click();\r\n            }\r\n        });\r\n\r\n        $scope.login = function () {\r\n            $scope.isFormTouched = true;\r\n            if (!$scope.data.userName || !$scope.data.password) {\r\n                toastr.warning('<img src=\"assets/img/Epic_Mass_Facepalm.gif\"/>');\r\n                toastr.warning('You had one Job!');\r\n            } else {\r\n                var data = {\r\n                    userName: $scope.data.userName,\r\n                    password: $scope.data.password\r\n                };\r\n                user.login(data)\r\n                    .then(function (response) {\r\n                            toastr.success('Login war erfolgreich.');\r\n                            var user = {\r\n                                userName: $scope.data.userName,\r\n                                role: response.role,\r\n                                id: parseInt(response.id)\r\n                            };\r\n                            localStorageService.set('user', user);\r\n                            $rootScope.$emit('login');\r\n                            localStorageService.remove('checkout');\r\n                            if (toCheckout) {\r\n                                $state.go('checkout');\r\n                            } else {\r\n                                $state.go('home');\r\n                            }\r\n                    }, function (error) {\r\n                        if (error) {\r\n                            toastr.error(error);\r\n                        } else {\r\n                            toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                        }\r\n                    });\r\n            }\r\n        }\r\n    }]);\n\r\nangular.module('app.orders', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('orders', {\r\n            url: '/orders',\r\n            templateUrl: 'app/orders/orders.html',\r\n            controller: 'OrdersCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('OrdersCtrl', [\"$scope\", \"$http\", \"localStorageService\", \"$state\", \"orders\", function ($scope, $http, localStorageService, $state, orders) {\r\n        var user = localStorageService.get(\"user\");\r\n        $scope.articles = localStorageService.get(\"articles\");\r\n        if (typeof user.id != \"number\") {\r\n            toastr.warning(\"Dieser Bereich ist geschützt. Bitte loggen Sie sich ein!\");\r\n            $state.go(\"home\");\r\n        } else {\r\n            orders.getOrders(user.id)\r\n                .then(function (response) {\r\n                    localStorageService.set(\"orders\", response);\r\n                    $scope.orders = response;\r\n                }, function (error) {\r\n                    if (error) {\r\n                        toastr.error(error);\r\n                    } else {\r\n                        toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                    }\r\n                });\r\n        }\r\n    }]);\n\r\nangular.module('app')\r\n    .factory('articles', [\"$q\", \"$http\", \"localStorageService\", \"$rootScope\", \"$log\", function ($q, $http, localStorageService, $rootScope, $log) {\r\n        var service = {};\r\n\r\n        service.getAllArticles = function () {\r\n            var q = $q.defer();\r\n            $http.get('http://localhost:8080/rest/article/get/all')\r\n                .then(function (response) {\r\n                    if (typeof response.data == 'string') {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        console.log(response.data);\r\n                        var mapped = _mapArticles(response.data);\r\n                        localStorageService.set('articles', mapped);\r\n                        $rootScope.$emit(\"articles-loaded\");\r\n                        $log.info(\"articles loaded\");\r\n                        q.resolve(mapped);\r\n                    }\r\n                }, function (error) {\r\n                    $log.error('loading articles failed: ', error);\r\n                    q.reject(error.statusText);\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n        service.getAllGenres = function () {\r\n            var q = $q.defer();\r\n            var genres = localStorageService.get('genres') || [];\r\n            if (!genres) {\r\n                service.getAllArticles()\r\n                    .then(function () {\r\n                        genres = localStorageService.get('genres') || [];\r\n                        q.resolve(genres);\r\n                    }, function (error) {\r\n                        q.reject(error.statusText);\r\n                    })\r\n            } else {\r\n                q.resolve(genres);\r\n            }\r\n            return q.promise;\r\n        };\r\n\r\n        service.addArticle = function (input) {\r\n            var q = $q.defer();\r\n            var data = {\r\n                ID : input.id.toString(),\r\n                Name : input.name,\r\n                Genre : input.genre,\r\n                Preis : input.price,\r\n                FSK : input.fsk,\r\n                Plattformen : input.platforms,\r\n                Release : input.release,\r\n                Sprache : input.language,\r\n                minRam : parseInt(input.minRam),\r\n                minProcessor : parseFloat(input.minProcessor),\r\n                Beschreibung : input.description,\r\n                image : input.image,\r\n                Rezensionen : []\r\n            };\r\n            $http.post('http://localhost:8080/rest/article/add', data)\r\n                .then(function (response) {\r\n                    if (response.data == \"Artikel existiert bereits\") {\r\n                        q.reject(response.data);\r\n                    } else if (response.data == \"Artikel konnte nicht hinzugefügt werden\") {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        service.getAllArticles();\r\n                        q.resolve(response.data);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error.statusText);\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n        service.addReview = function (input) {\r\n            var q = $q.defer();\r\n            var date = new Date().getTime();\r\n            var data = {\r\n                ID : '0',\r\n                idArticle : input.articleId.toString(),\r\n                stars : input.stars.toString(),\r\n                Autor : input.author,\r\n                Titel : input.title,\r\n                Text : input.message,\r\n                Datum : date.toString()\r\n            };\r\n            $http.post('http://localhost:8080/rest/review/add', data)\r\n                .then(function (response) {\r\n                    if (response.data == 'Rezension konnte nicht hinzugefügt werden') {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        service.getAllArticles();\r\n                        q.resolve(response.data);\r\n                    }\r\n                }, function (error) {\r\n                    $log.error(\"error adding review:\", error);\r\n                    q.reject(error.statusText);\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n        service.getTopGames = function () {\r\n            var q = $q.defer();\r\n            $http.get(\"http://localhost:8080/rest/article/get/top\")\r\n                .then(function (response) {\r\n                    var top = [];\r\n                    angular.forEach(response.data, function (item) {\r\n                        top.push(parseInt(item.ID));\r\n                        localStorageService.set(\"top-games\", top);\r\n                    });\r\n                    q.resolve(top);\r\n                }, function (error) {\r\n                    if (error.statusText) {\r\n\r\n                    }\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n\r\n        var _mapArticles = function (articles) {\r\n            var mappedItems = {};\r\n            var genres = [];\r\n\r\n            angular.forEach(articles, function (item) {\r\n                // Genres\r\n                var isNewGenre = true;\r\n                angular.forEach(genres, function (genre) {\r\n                    if (item.Genre == genre) {\r\n                        isNewGenre = false;\r\n                    }\r\n                });\r\n\r\n                var mappedItem = {\r\n                    id : parseInt(item.ID),\r\n                    name : item.Name,\r\n                    genre : item.Genre,\r\n                    price : parseFloat(item.Preis),\r\n                    fsk : parseInt(item.FSK),\r\n                    platforms : trimPlatforms(item.Plattformen),\r\n                    release : item.Release,\r\n                    language : item.Sprache,\r\n                    minRam : item.minRam,\r\n                    minProcessor : item.minProcessor,\r\n                    image : item.image,\r\n                    description : item.Beschreibung,\r\n                    reviews : _mapReviews(item.Rezensionen)\r\n                };\r\n                if (isNewGenre) {\r\n                    genres.push(mappedItem.genre);\r\n                }\r\n                mappedItems[mappedItem.id] = mappedItem;\r\n            });\r\n            localStorageService.set('genres', genres);\r\n            return mappedItems;\r\n        };\r\n\r\n        function trimPlatforms(input) {\r\n            var trimmed = [];\r\n            angular.forEach(input, function (item) {\r\n                trimmed.push(item.trim());\r\n            });\r\n            return trimmed;\r\n        }\r\n\r\n        var _mapReviews = function (reviews) {\r\n            var mappedItems = [];\r\n            angular.forEach(reviews, function (item) {\r\n                var mappedItem = {\r\n                    id : parseInt(item.ID),\r\n                    stars : parseInt(item.stars),\r\n                    author : item.Autor,\r\n                    title : item.Titel,\r\n                    message : item.Text,\r\n                    date : parseInt(item.Datum)\r\n                };\r\n                mappedItems.push(mappedItem);\r\n            });\r\n            return mappedItems || [];\r\n        };\r\n        return service;\r\n    }]);\n\r\nangular.module('app')\r\n    .factory('orders', [\"$q\", \"$http\", \"localStorageService\", function ($q, $http, localStorageService) {\r\n        var service = {};\r\n\r\n        service.addOrder = function (input) {\r\n            var q = $q.defer();\r\n            var data = {\r\n                ID: '0',\r\n                idUser: input.userId.toString(),\r\n                Datum: input.date.toString(),\r\n                Preis: input.totalPrice.toString(),\r\n                Bestellungsartikel: mapCartItems(input.items)\r\n            };\r\n            console.log(data);\r\n            $http.post(\"http://localhost:8080/rest/order/add\", data)\r\n                .then(function(response) {\r\n                    if (response.data == \"Bestellung konnte nicht hinzugefügt werden\") {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        q.resolve(response.data);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error.statusText);\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n        service.getOrders = function (id) {\r\n            var q = $q.defer();\r\n            $http.get(\"http://localhost:8080/rest/order/get/\" + id)\r\n                .then(function (response) {\r\n                    if(response.data == \"Bestellungen konnten nicht geladen werden\") {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        var orders = _mapOrders(response.data);\r\n                        q.resolve(orders);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error.statusText);\r\n                });\r\n\r\n            return q.promise;\r\n        };\r\n\r\n        function _mapOrders(input) {\r\n            var mapped = [];\r\n            angular.forEach(input, function (order) {\r\n                var mappedOrder = {};\r\n                mappedOrder = {\r\n                    id: parseInt(order.ID),\r\n                    userId: parseInt(order.idUser),\r\n                    date: parseInt(order.Datum),\r\n                    totalPrice: parseFloat(order.Preis),\r\n                    articles: _mapArticles(order.Bestellungsartikel)\r\n                };\r\n                mapped.push(mappedOrder);\r\n            });\r\n            return mapped;\r\n        }\r\n\r\n        function _mapArticles(input) {\r\n            var mapped = [];\r\n            angular.forEach(input, function (item) {\r\n                var mappedItem = {};\r\n                mappedItem = {\r\n                    id: parseInt(item.idArticle),\r\n                    quantity: parseInt(item.Anzahl),\r\n                    price: parseFloat(item.Preis),\r\n                    name: item.Name\r\n                };\r\n                mapped.push(mappedItem);\r\n            });\r\n            return mapped;\r\n        }\r\n\r\n        function mapCartItems(input) {\r\n            var articles = localStorageService.get(\"articles\") || {};\r\n            var mapped = [];\r\n            angular.forEach(input, function (item) {\r\n                var mappedItem = {};\r\n                if (articles[item.itemId]) {\r\n                    mappedItem = {\r\n                        idArticle : item.itemId.toString(),\r\n                        Name: articles[item.itemId].name,\r\n                        Anzahl : item.quantity.toString(),\r\n                        idOrder : '0',\r\n                        Preis : articles[item.itemId].price.toString()\r\n                    };\r\n                    mapped.push(mappedItem);\r\n                }\r\n            });\r\n            return mapped;\r\n        }\r\n\r\n        return service;\r\n    }]);\n\r\nangular.module('app')\r\n    .factory('user', [\"$q\", \"$http\", \"localStorageService\", function ($q, $http, localStorageService) {\r\n        var service = {};\r\n\r\n        service.addUser = function (input) {\r\n            var q = $q.defer();\r\n            var data = {\r\n                ID : '0',\r\n                Benutzername : input.userName,\r\n                Passwort : input.password,\r\n                Email : input.email,\r\n                Rolle : input.role\r\n            };\r\n            $http.post('http://localhost:8080/rest/user/add', data)\r\n                .then(function (response) {\r\n                    if (response.data == \"User konnte nicht angelegt werden\" || response.data == \"User existiert bereits\") {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        q.resolve(response.data);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error.statusText);\r\n                });\r\n            return q.promise;\r\n        };\r\n\r\n        service.login = function (input) {\r\n            var q = $q.defer();\r\n            $http.get('http://localhost:8080/rest/user/get/' + input.userName)\r\n                .then(function (response) {\r\n                    console.log(response);\r\n                    if (response.data == \"User konnten nicht geladen werden\") {\r\n                        q.reject(response.data);\r\n                    } else if (response.data.Benutzername == \"null\") {\r\n                        q.reject(\"Benutzer existiert nicht!\")\r\n                    } else if (response.data.Passwort === input.password) {\r\n                        q.resolve({role : response.data.Rolle, id : response.data.ID});\r\n                    } else {\r\n                        q.reject(\"Passwort falsch!\");\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error.statusText);\r\n                });\r\n\r\n            return q.promise;\r\n        };\r\n\r\n        service.getAllUsers = function () {\r\n            var q = $q.defer();\r\n\r\n            $http.get(\"http://localhost:8080/rest/users/get\")\r\n                .then(function (response) {\r\n                    if (typeof response.data == 'string') {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        var users = _mapUsers(response.data);\r\n                        q.resolve(users);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error);\r\n                });\r\n\r\n            return q.promise;\r\n        };\r\n        \r\n        service.deleteUser = function (userName) {\r\n            var q = $q.defer();\r\n\r\n            $http.get(\"http://localhost:8080/rest/user/delete/\" + userName)\r\n                .then(function (response) {\r\n                    if (response.data == \"User existiert nicht\" || response.data == \"Hat nicht funktioniert\") {\r\n                        q.reject(response.data);\r\n                    } else {\r\n                        q.resolve(response.data);\r\n                    }\r\n                }, function (error) {\r\n                    q.reject(error);\r\n                });\r\n\r\n            return q.promise;\r\n        };\r\n\r\n        function _mapUsers(input) {\r\n            var mapped = [];\r\n\r\n            angular.forEach(input, function (user) {\r\n                var mappedItem = {};\r\n                mappedItem = {\r\n                    id : parseInt(user.ID),\r\n                    userName: user.Benutzername,\r\n                    email: user.Email,\r\n                    role: user.Rolle\r\n                };\r\n                mapped.push(mappedItem);\r\n            });\r\n            return mapped;\r\n        }\r\n\r\n        return service;\r\n    }]);\n\r\nangular.module('app.topGames', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('topGames', {\r\n            url: '/topGames',\r\n            templateUrl: 'app/topGames/topGames.html',\r\n            controller: 'TopGamesCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('TopGamesCtrl', [\"$scope\", \"articles\", \"localStorageService\", function ($scope, articles, localStorageService) {\r\n        $scope.topGames = localStorageService.get(\"top-games\") || [];\r\n        $scope.articles = localStorageService.get(\"articles\");\r\n        articles.getTopGames()\r\n            .then(function () {\r\n                $scope.topGames = localStorageService.get(\"top-games\") || [];\r\n            }, function (error) {\r\n                toastr.error(error);\r\n            });\r\n        articles.getAllArticles();\r\n    }]);\n\r\nangular.module('app.userAdministration', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('userAdministration', {\r\n            url : '/userAdministration',\r\n            templateUrl : 'app/userAdministration/userAdministration.html',\r\n            controller : 'UserAdministrationCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('UserAdministrationCtrl', [\"$scope\", \"user\", function ($scope, user) {\r\n        function loadUsers() {\r\n            user.getAllUsers()\r\n                .then(function (response) {\r\n                    $scope.users = response;\r\n                }, function (error) {\r\n                    if (error) {\r\n                        toastr.error(error);\r\n                    } else {\r\n                        toastr.error(\"Verbindung zum Server fehlgeschlagen!\");\r\n                    }\r\n                });\r\n        }\r\n\r\n        loadUsers();\r\n\r\n        $scope.deleteUser = function (userName) {\r\n            user.deleteUser(userName)\r\n                .then(function (response) {\r\n                    toastr.success(response);\r\n                    loadUsers();\r\n                }, function (error) {\r\n                    toastr.error(error);\r\n                });\r\n        }\r\n    }]);\n\r\nangular.module('app.gameDetail')\r\n    .controller('RatingCtrl', [\"$scope\", \"$uibModalInstance\", \"stars\", \"title\", \"message\", function ($scope, $uibModalInstance, stars, title, message) {\r\n        \r\n        $scope.stars = stars;\r\n        $scope.message = message;\r\n        $scope.title = title;\r\n        title ? $scope.isNewReview = false: $scope.isNewReview = true;\r\n\r\n        $scope.checkValid = function () {\r\n            $scope.message && $scope.title ? $scope.isValid = true : $scope.isValid = false;\r\n        };\r\n        $scope.checkValid();\r\n\r\n        $scope.submit = function () {\r\n            var result = {\r\n                title: $scope.title,\r\n                message: $scope.message,\r\n                stars: $scope.stars\r\n            };\r\n            $uibModalInstance.close(result);\r\n        };\r\n        $scope.cancel = function () {\r\n            $uibModalInstance.dismiss();\r\n        };\r\n    }]);\n\r\nangular.module('app.checkout', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('checkout', {\r\n            url : '/checkout',\r\n            templateUrl : 'app/cart/checkout/checkout.html',\r\n            controller : 'CheckoutCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('CheckoutCtrl', [\"$scope\", \"localStorageService\", \"$state\", \"orders\", function ($scope, localStorageService, $state, orders) {\r\n        var user = localStorageService.get('user') || {};\r\n        if (!user.userName) {\r\n            localStorageService.set('fromCheckout', true);\r\n            toastr.info('Bitte melden Sie sich an.');\r\n            $state.go('login');\r\n        }\r\n        var cart = localStorageService.get('cart') || {};\r\n        var articles = localStorageService.get('articles') || {};\r\n        $scope.cart = {};\r\n\r\n        $scope.updateTotalPrice = function () {\r\n            $scope.totalPrice = 0;\r\n            angular.forEach($scope.cart, function (item) {\r\n                $scope.totalPrice += item.quantity * item.price;\r\n            });\r\n        };\r\n\r\n        angular.forEach(articles, function (article) {\r\n            angular.forEach(cart, function (item) {\r\n                if (item.itemId == article.id) {\r\n                    var newObject = article;\r\n                    newObject.quantity = item.quantity;\r\n                    $scope.cart[item.itemId] = newObject;\r\n                }\r\n            });\r\n        });\r\n\r\n        $scope.addOrder = function () {\r\n            var cart = localStorageService.get(\"cart\");\r\n            var data = {\r\n                userId : user.id,\r\n                date : new Date().getTime(),\r\n                totalPrice : $scope.totalPrice,\r\n                items : cart\r\n            };\r\n            orders.addOrder(data)\r\n                .then(function (response) {\r\n                    toastr.success(response);\r\n                    localStorageService.remove(\"cart\");\r\n                    $state.go(\"orders\");\r\n                }, function (error) {\r\n                    if (!error) {\r\n                        toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                    } else {\r\n                        toastr.error(error);\r\n                    }\r\n                });\r\n        };\r\n        $scope.updateTotalPrice();\r\n\r\n    }]);\n\r\nangular.module('app.passwordForget', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('passwordForget', {\r\n            url: '/passwordForget',\r\n            templateUrl: 'app/login/passwordForget/passwordForget.html',\r\n            controller: 'PasswordForgetCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('PasswordForgetCtrl', [\"$scope\", function ($scope) {\r\n        $scope.data = {};\r\n        $scope.data.email = '';\r\n        $scope.submit = function () {\r\n            if (!$scope.email) {\r\n                toastr.warning('Ungültige Email-Adresse!');\r\n            } else {\r\n                toastr.success('Gültige Eingabe.');\r\n            }\r\n        }\r\n    }]);\n\r\nangular.module('app.register', [])\r\n\r\n    .config([\"$stateProvider\", function ($stateProvider) {\r\n        $stateProvider.state('register', {\r\n            url: '/register',\r\n            templateUrl: 'app/login/register/register.html',\r\n            controller: 'RegisterCtrl'\r\n        });\r\n    }])\r\n\r\n    .controller('RegisterCtrl', [\"$scope\", \"user\", \"$state\", function ($scope, user, $state) {\r\n        $scope.data = {};\r\n        $scope.data.userName = '';\r\n        $scope.data.email = '';\r\n        $scope.data.password = '';\r\n        $scope.data.passwordConfirm = '';\r\n        $scope.isTouched = false;\r\n        $scope.pattern = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n\r\n\r\n        $scope.register = function () {\r\n            $scope.isTouched = true;\r\n            if (!$scope.data.userName || !$scope.data.password || !$scope.data.passwordConfirm) {\r\n                toastr.warning('Alle Felder müssen ausgefüllt werden!', 'Fehlende Informationen!');\r\n            } else if (!$scope.data.email || !$scope.pattern.test($scope.data.email)) {\r\n                toastr.warning('Die Email-Adresse ist ungültig!', 'Fehlerhafte Informationen!');\r\n            } else if ($scope.data.password != $scope.data.passwordConfirm) {\r\n                toastr.warning('Die Passwörter stimmen nicht überein.', 'Fehlerhafte Informationen!');\r\n            } else if ($scope.data.userName.length < 4) {\r\n                toastr.warning('Benutzername zu kurz!');\r\n            } else if ($scope.data.password.length < 6) {\r\n                toastr.warning('Passwort zu kurz!');\r\n            } else {\r\n                var data = {\r\n                    userName: $scope.data.userName,\r\n                    password: $scope.data.password,\r\n                    email: $scope.data.email,\r\n                    role: 'user'\r\n                };\r\n                user.addUser(data)\r\n                    .then(function() {\r\n                        toastr.success(\"Der Benutzer wurde erfolgreich angelegt!\");\r\n                        $state.go('login');\r\n                        toastr.info(\"Bitte loggen Sie sich mit den neuen Daten an.\");\r\n                    }, function (error) {\r\n                        if (error) {\r\n                            toastr.error(error);\r\n                        } else {\r\n                            toastr.error(\"Fehler bei der Verbindung zum Server!\");\r\n                        }\r\n                    });\r\n            }\r\n        }\r\n    }]);\n\n})(window, document);\n"],"sourceRoot":"/source/"}
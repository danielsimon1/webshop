!function(e,t,r){"use strict";angular.module("app",["ui.router","ui.bootstrap","LocalStorageModule","ngAnimate","templates","textAngular","app.home","app.addArticle","app.topGames","app.newGames","app.gameDetail","app.login","app.genre","app.cart","app.checkout","app.orders","app.userAdministration","app.register","app.passwordForget"]).config(["$urlRouterProvider","localStorageServiceProvider",function(e,t){e.otherwise("/home"),t.setPrefix("webshop"),toastr.options={closeButton:!1,debug:!1,newestOnTop:!0,progressBar:!1,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}}]).run(["localStorageService","articles","$rootScope","$log",function(e,t,r,a){t.getAllArticles().then(function(t){r.$emit("genresLoaded"),e.set("articles",t)},function(t){var r=e.get("articles");r?toastr.warning("Artikel konnten nicht neu geladen werden. Daten sind möglicherweise veraltet."):toastr.error("Artikel konnten nicht geladen werden."),a.error(t)}),e.set("fromCheckout",!1)}]).controller("AppCtrl",["$scope","$rootScope","$http","localStorageService","$state","articles","$log",function(e,t,r,a,n,o,i){a.remove("checkout"),t.$on("$stateChangeSuccess",function(t,r,a){e.currentStateName=r.name,e.currentStateParams=a.name}),t.$on("itemAddedToCart",function(){l()}),t.$on("login",function(){s()}),t.$on("genresLoaded",function(){o.getAllGenres().then(function(t){e.genres=t},function(e){i.error(e)})}),e.logout=function(){a.remove("user"),a.remove("orders"),a.remove("checkout"),t.$emit("login"),t.$emit("itemAddedToCart"),toastr.success("Logout war erfolgreich."),n.go("login")};var s=function(){var t=a.get("user")||{};e.userName=t.userName||"Benutzer",e.userRole=t.role};s();var l=function(){var t=a.get("cart");e.quantity=0,angular.forEach(t,function(t){e.quantity+=t.quantity})};l()}]).directive("imageonload",function(){return{restrict:"A",link:function(e,t,r){t.bind("load",function(){e.isImage=!0,e.$apply()}),t.bind("error",function(){e.isImage=!1,e.$apply()})}}}).filter("objectFilter",function(){return function(e,t){var r=[];return t=t?t.toLowerCase():"",angular.forEach(e,function(e,a){-1!==e.name.toLowerCase().indexOf(t)&&r.push(e)}),r}}),angular.module("app.addArticle",[]).config(["$stateProvider",function(e){e.state("addArticle",{url:"/addArticle",templateUrl:"app/addArticle/addArticle.html",controller:"AddArticleCtrl"})}]).controller("AddArticleCtrl",["$scope","articles","$log",function(e,t,r){function a(){var t=[];return angular.forEach(e.selected.platform,function(e,r){e&&t.push(r)}),t}function n(e){return/(?=.)^\$?(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+)?(\.[0-9]{1,2})?$/.test(e)}e.selected={},e.selected.platform={},e.selected.fsk="0",e.isTouched=!1,e.isPriceInvalid=!1,e.isPriceTouched=!1,e.isCustomGenre=!1,e.genreButtonText="Neues Genre anlegen",t.getAllGenres().then(function(t){e.genres=t},function(e){r.error(e)}),e.changeInputStyle=function(){e.isCustomGenre?e.isCustomGenre=!1:e.isCustomGenre=!0,"Neues Genre anlegen"==e.genreButtonText?e.genreButtonText="Vorhandenes Genre auswählen":e.genreButtonText="Neues Genre anlegen"},e.priceValidation=function(){e.isPriceTouched=!0,n(e.price)?e.isPriceInvalid=!1:e.isPriceInvalid=!0},e.test=function(){(!e.selected.genre&&!e.isCustomGenre||!e.customGenre&&e.isCustomGenre)&&console.log("invalid")},e.imageToBase64=function(t){if(t.files&&t.files[0]){var r=new FileReader;r.onload=function(t){console.log("image successfully converted to Base64"),e.image=t.target.result,e.$apply()},r.readAsDataURL(t.files[0])}},e.addArticle=function(){if(e.isTouched=!0,e.isPriceTouched=!0,e.isPriceInvalid=!1,e.title&&(e.selected.genre&&!e.isCustomGenre||e.customGenre&&e.isCustomGenre)&&e.price&&(e.selected.platform.wiiu||e.selected.platform.windows||e.selected.platform.ps||e.selected.platform.xbox||e.selected.platform.osx)&&e.release&&e.language&&e.minRam&&e.minProcessor&&e.description&&e.image)if(n(e.price)){var r={id:2,name:e.title,genre:e.isCustomGenre?e.customGenre:e.selected.genre,price:e.price,fsk:e.selected.fsk,platforms:a(),release:e.release,language:e.language,minRam:e.minRam,minProcessor:e.minProcessor,description:e.description,image:e.image};console.log(r),t.addArticle(r).then(function(e){},function(e){})}else toastr.warning("Ungültiger Preis!"),e.isPriceInvalid=!0;else toastr.warning("Fehlende Informationen!")}}]),angular.module("app.gameDetail",[]).config(["$stateProvider",function(e){e.state("gameDetail",{url:"/gameDetail/:id",templateUrl:"app/gameDetail/gameDetail.html",controller:"GameDetailCtrl"})}]).controller("GameDetailCtrl",["$scope","$http","$stateParams","localStorageService","$rootScope","$uibModal","$state",function(e,r,a,n,o,i,s){e.tab={},e.tab.active="description",e.quantity=1;var l=n.get("user")||{},c=l.userName,u=function(e){var t=0,r=0;return angular.forEach(e,function(e){t++,r+=e.stars}),r/t};e.changeTab=function(t){e.tab.active=t};var g=a.id;e.articles=n.get("articles"),e.actualGame=e.articles[g],e.actualGame||(toastr.warning("Das Spiel mit der ID "+g+" existiert nicht!"),s.go("home")),e.stars=u(e.actualGame.reviews),t.getElementById("description").innerHTML=e.actualGame.description,e.toCart=function(){if(e.quantity>=1){var t=n.get("cart")||{};t[e.actualGame.id]&&t[e.actualGame.id].quantity?t[e.actualGame.id].quantity=parseInt(t[e.actualGame.id].quantity)+parseInt(e.quantity):t[e.actualGame.id]={itemId:e.actualGame.id,quantity:parseInt(e.quantity)},n.set("cart",t),o.$emit("itemAddedToCart"),toastr.success("Artikel erfolgreich "+e.quantity+"x in den Warenkorb gelegt!"),toastr.success('<img src="assets/img/giphy.gif" ng-show="inCart"/>'),e.quantity=1}else toastr.warning("Bitte geben Sie eine gültige Zahl ein!")},e.starsActivator={},e.numbers=[1,2,3,4,5];for(var m=0;4>=m;m++)e.starsActivator[e.numbers[m]]=!1;e.starHover=function(t){for(;t>0;)e.starsActivator[t]=!0,t--},e.leave=function(){for(var t=0;4>=t;t++)e.starsActivator[e.numbers[t]]=!1},e.rate=function(t){if(c){var r=1;do r++;while(e.actualGame.reviews[r]);var a="",o="";angular.forEach(e.actualGame.reviews,function(e){e.author==l&&(a=e.title,o=e.message,r=e.id)});var s=i.open({animation:!0,templateUrl:"app/gameDetail/rating/rating.html",controller:"RatingCtrl",resolve:{stars:function(){return t},title:function(){return a},message:function(){return o}}});s.result.then(function(t){e.actualGame.reviews[r]={id:r,stars:t.stars,title:t.title,message:t.message,author:c},e.articles[g].reviews=e.actualGame.reviews,n.set("articles",e.articles),e.stars=u(e.actualGame.reviews),toastr.success("Bewertung hinzugefügt!")},function(){console.log("Modal dismissed")})}else toastr.warning("Bitte loggen Sie sich zuerst ein!")}}]),angular.module("app.genre",[]).config(["$stateProvider",function(e){e.state("genre",{url:"/genre/:name",templateUrl:"app/genre/genre.html",controller:"GenreCtrl"})}]).controller("GenreCtrl",["$stateParams","localStorageService","$scope",function(e,t,r){r.searchInout={},r.genre=e.name;var a=t.get("articles");r.articles={},r.isArticles=!1,"Alle Spiele"!=r.genre?angular.forEach(a,function(e){e.genre==r.genre&&(r.isArticles=!0,r.articles[e.id]=e)}):(r.isArticles=!0,r.articles=a)}]),angular.module("app.cart",[]).config(["$stateProvider",function(e){e.state("cart",{url:"/cart",templateUrl:"app/cart/cart.html",controller:"CartCtrl"})}]).controller("CartCtrl",["localStorageService","$scope","$rootScope",function(e,t,r){var a=e.get("cart"),n=e.get("articles");t.cart={},t.updateTotalPrice=function(){t.totalPrice=0,angular.forEach(t.cart,function(e){t.totalPrice+=e.quantity*e.price})},angular.forEach(n,function(e){angular.forEach(a,function(r){if(r.itemId==e.id){var a=e;a.quantity=r.quantity,console.log(a),t.cart[r.itemId]=a}})}),t.updateTotalPrice(),t.quantityChange=function(n){a[n].quantity=parseInt(t.cart[n].quantity),t.updateTotalPrice(),e.set("cart",a),r.$emit("itemAddedToCart")},t.remove=function(n){delete t.cart[n],delete a[n],t.updateTotalPrice(),e.set("cart",a),r.$emit("itemAddedToCart")}}]),angular.module("app.home",[]).config(["$stateProvider",function(e){e.state("home",{url:"/home",templateUrl:"app/home/home.html",controller:"HomeCtrl"})}]).controller("HomeCtrl",function(){}),angular.module("app.orders",[]).config(["$stateProvider",function(e){e.state("orders",{url:"/orders",templateUrl:"app/orders/orders.html",controller:"OrdersCtrl"})}]).controller("OrdersCtrl",["$scope","$http","localStorageService",function(e,t,r){var a=new Date;console.log(a),t.get("../assets/json/orders.json").then(function(t){r.set("orders",t.data),e.orders=t.data,console.log(e.orders)},function(t){var a=r.get("orders");a?(toastr.warning("Bestellungen konnten nicht geladen werden! Daten sind möglicherweise veraltet."),e.orders=a):toastr.error("Bestellungen konnten nicht geladen werden! Bitte verbinden Sie sich mit dem Internet."),console.log(t)})}]),angular.module("app.login",[]).config(["$stateProvider",function(e){e.state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginCtrl"})}]).controller("LoginCtrl",["$scope","$state","localStorageService","$rootScope","$http","$log",function(e,t,r,a,n,o){e.isFormTouched=!1;var i=r.get("user")||{},s=r.get("fromCheckout");i.userName&&(toastr.info('Sie sind bereits eingeloogt als "'+i.userName+'"!'),t.go("home")),e.data={},e.data.password="",e.data.userName="",$("#username").keydown(function(e){13==e.keyCode&&$("#submit").click()}),$("#password").keydown(function(e){13==e.keyCode&&$("#submit").click()}),e.login=function(){if(e.isFormTouched=!0,e.data.userName&&e.data.password){toastr.success("Login war erfolgreich.");var n="admin",o={userName:e.data.userName,role:n};r.set("user",o),a.$emit("login"),r.remove("checkout"),s?t.go("checkout"):t.go("home")}else toastr.warning('<img src="assets/img/Epic_Mass_Facepalm.gif"/>'),toastr.warning("You had one Job!")}}]),angular.module("app.newGames",[]).config(["$stateProvider",function(e){e.state("newGames",{url:"/newGames",templateUrl:"app/newGames/newGames.html",controller:"NewGamesCtrl"})}]).controller("NewGamesCtrl",function(){}),angular.module("app").factory("articles",["$q","$http","localStorageService",function(e,t,r){function a(e){var t=[];return angular.forEach(e,function(e){t.push(e.trim())}),t}var n={};n.getAllArticles=function(){var a=e.defer();return t.get("http://localhost:8080/rest/article/all").then(function(e){var t=o(e.data);r.set("articles",t),a.resolve(t)},function(e){a.reject(e)}),a.promise},n.getAllGenres=function(){var t=e.defer(),a=r.get("genres")||[];return a?t.resolve(a):this.getAllArticles().then(function(){a=r.get("genres")||[],t.resolve(a)},function(e){t.reject(e)}),t.promise},n.addArticle=function(r){var a=e.defer(),n={ID:r.id.toString(),Name:r.name,Genre:r.genre,Preis:r.price,FSK:r.fsk,Plattformen:r.platforms,Release:r.release,Sprache:r.language,minRam:parseInt(r.minRam),minProcessor:parseFloat(r.minProcessor),Beschreibung:r.description,image:r.image,Rezensionen:[]};return console.log(n),t.post("http://localhost:8080/rest/article",n).then(function(e){console.log(e),a.resolve(e)},function(e){console.log(e),a.reject(e)}),a.promise};var o=function(e){var t={},n=[];return angular.forEach(e,function(e){var r=!0;angular.forEach(n,function(t){e.genre==t&&(r=!1)});var o={id:parseInt(e.ID),name:e.Name,genre:e.Genre,price:parseFloat(e.Preis),fsk:parseInt(e.FSK),platforms:a(e.Plattformen),release:e.Release,language:e.Sprache,minRam:e.minRam,minProcessor:e.minProcessor,image:e.image,description:e.Beschreibung,reviews:i(e.Rezensionen)};r&&n.push(o.genre),t[o.id]=o,console.log(o)}),r.set("genres",n),t},i=function(e){var t={};return angular.forEach(e,function(e){var r={id:e.id,stars:e.stars,author:e.author,title:e.title,message:e.message};t[r.id]=r}),t};return n}]),angular.module("app.topGames",[]).config(["$stateProvider",function(e){e.state("topGames",{url:"/topGames",templateUrl:"app/topGames/topGames.html",controller:"TopGamesCtrl"})}]).controller("TopGamesCtrl",function(){}),angular.module("app.userAdministration",[]).config(["$stateProvider",function(e){e.state("userAdministration",{url:"/userAdministration",templateUrl:"app/userAdministration/userAdministration.html",controller:"UserAdministrationCtrl"})}]).controller("UserAdministrationCtrl",function(){}),angular.module("app.gameDetail").controller("RatingCtrl",["$scope","$uibModalInstance","stars","title","message",function(e,t,r,a,n){e.stars=r,e.message=n,e.title=a,e.checkValid=function(){e.message&&e.title?e.isValid=!0:e.isValid=!1},e.checkValid(),e.submit=function(){var r={title:e.title,message:e.message,stars:e.stars};t.close(r)},e.cancel=function(){t.dismiss()}}]),angular.module("app.checkout",[]).config(["$stateProvider",function(e){e.state("checkout",{url:"/checkout",templateUrl:"app/cart/checkout/checkout.html",controller:"CheckoutCtrl"})}]).controller("CheckoutCtrl",["$scope","localStorageService","$state",function(e,t,r){var a=t.get("user")||{};a.userName||(t.set("fromCheckout",!0),toastr.info("Bitte melden Sie sich an."),r.go("login"));var n=t.get("cart")||{},o=t.get("articles")||{};e.cart={},e.updateTotalPrice=function(){e.totalPrice=0,angular.forEach(e.cart,function(t){e.totalPrice+=t.quantity*t.price})},angular.forEach(o,function(t){angular.forEach(n,function(r){if(r.itemId==t.id){var a=t;a.quantity=r.quantity,e.cart[r.itemId]=a}})}),e.updateTotalPrice()}]),angular.module("app.passwordForget",[]).config(["$stateProvider",function(e){e.state("passwordForget",{url:"/passwordForget",templateUrl:"app/login/passwordForget/passwordForget.html",controller:"PasswordForgetCtrl"})}]).controller("PasswordForgetCtrl",["$scope",function(e){e.data={},e.data.email="",e.submit=function(){e.email?toastr.success("Gültige Eingabe."):toastr.warning("Ungültige Email-Adresse!")}}]),angular.module("app.register",[]).config(["$stateProvider",function(e){e.state("register",{url:"/register",templateUrl:"app/login/register/register.html",controller:"RegisterCtrl"})}]).controller("RegisterCtrl",["$scope","$http","$log",function(e,t,r){e.data={},e.data.userName="",e.data.email="",e.data.password="",e.data.passwordConfirm="",e.register=function(){if(e.data.userName&&e.data.password&&e.data.passwordConfirm)if(e.data.email)if(e.data.password!=e.data.passwordConfirm)toastr.warning("Die Passwörter stimmen nicht überein.","Fehlerhafte Informationen!");else{({id:"0000",username:e.data.userName,password:e.data.password,email:e.data.email,role:"user"})}else toastr.warning("Die Email-Adresse ist ungültig!","Fehlerhafte Informationen!");else toastr.warning("Alle Felder müssen ausgefüllt werden!","Fehlende Informationen!")}}])}(window,document);
//# sourceMappingURL=app.min.js.map
